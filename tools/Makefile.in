# This makefile is used to convert Tcl manual pages into various
# alternate formats:
#
#    Windows help file:  1. Build the winhelp target on Unix
#			 2. Build the helpfile target on Windows
#
#    HTML:		 1. Build the html target on Unix

# RCS: @(#) $Id$

#TCL = tcl@TCL_VERSION@@TCL_PATCH_LEVEL@
#TK = tk@TCL_VERSION@@TCL_PATCH_LEVEL@
TCL = tcl@TCL_VERSION@
TK = tk@TCL_VERSION@
VER=@TCL_WIN_VERSION@

TCL_SOURCE = @srcdir@/..
TK_SOURCE = @srcdir@/../../$(TK)
PRO_SOURCE = @srcdir@/../../pro
ITCL_SOURCE = @srcdir@/../../itcl3.0.1

TCL_DOCS = \
	$(TCL_SOURCE)/doc/*.[13n]

TK_DOCS = \
	$(TK_SOURCE)/doc/*.[13n]

PRO_DOCS = \
	$(PRO_SOURCE)/doc/man/*.[13n]

ITCL_DOCS = \
	$(ITCL_SOURCE)/itcl/doc/*.[13n] \
	$(ITCL_SOURCE)/itk/doc/*.[13n]

#	$(ITCL_SOURCE)/iwidgets3.0.0/doc/*.[13n]

COREDOCS = $(TCL_DOCS) $(TK_DOCS) 
PRODOCS = $(COREDOCS) $(PRO_DOCS) $(ITCL_DOCS)
TCLSH = $(TCL_SOURCE)/unix/tclsh
CC=@CC@

all: core

pro:
	$(MAKE) PRODOCS="$(PRODOCS)" VER="" rtf

core:
	$(MAKE) DOCS="$(COREDOCS)" rtf

rtf: man2help.tcl man2tcl $(DOCS)
	LD_LIBRARY_PATH=$(TCL_SOURCE)/unix \
	$(TCLSH) man2help.tcl tcl "$(VER)" $(DOCS)

winhelp: tcl.rtf

man2tcl: man2tcl.c
	$(CC) $(CFLAGS) -o man2tcl man2tcl.c

clean:
	-rm -f man2tcl *.o *.cnt *.rtf

helpfile:
	hcw /c tcl.hpj

#	mv tcl.hlp tcl$(VER).hlp

